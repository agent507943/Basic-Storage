[
  {"question": "What is the primary purpose of TLS in web communication?", "choices": ["To speed up page loads", "To encrypt data in transit and ensure integrity", "To manage DNS records", "To authenticate API keys"], "answer": "To encrypt data in transit and ensure integrity", "difficulty": "easy", "explanation": "TLS provides confidentiality, integrity, and optional server/client authentication for data in transit."},
  {"question": "What role does a Certificate Authority (CA) play?", "choices": ["Issuing TLS certificates", "Hosting websites", "Providing DNS services", "Managing APIs"], "answer": "Issuing TLS certificates", "difficulty": "easy", "explanation": "CAs sign and issue X.509 certificates that browsers and systems trust."},
  {"question": "What is certificate pinning?", "choices": ["Forcing a CA to renew a cert", "Binding an expected certificate/public key to a client", "Revoking certificates", "A DNS record type"], "answer": "Binding an expected certificate/public key to a client", "difficulty": "medium", "explanation": "Pinning makes clients accept only a known certificate or public key, reducing MITM risk but increasing operational complexity."},
  {"question": "Which header helps prevent clickjacking by controlling framing?", "choices": ["Content-Security-Policy", "X-Frame-Options", "Strict-Transport-Security", "Referrer-Policy"], "answer": "X-Frame-Options", "difficulty": "easy", "explanation": "X-Frame-Options or frame-ancestors in CSP prevent the page from being framed."},
  {"question": "Which is a good practice for API key storage on servers?", "choices": ["Hard-code keys in source code", "Store in environment variables or secret manager", "Place in public repo", "Send keys to client-side JS"], "answer": "Store in environment variables or secret manager", "difficulty": "easy", "explanation": "Secrets should be stored in secure secret stores or environment variables and not committed to source control."},
  {"question": "What is the best description of MFA?", "choices": ["Multiple failed attempts allowed", "Multi-Factor Authentication: multiple independent proofs of identity", "Manual firewall adjustments", "Mutual TLS only"], "answer": "Multi-Factor Authentication: multiple independent proofs of identity", "difficulty": "easy", "explanation": "MFA requires two or more independent credentials (something you know, have, or are)."},
  {"question": "Which attack exploits cookie replay or session fixation?", "choices": ["XSS", "CSRF", "Session Hijacking", "SQL Injection"], "answer": "Session Hijacking", "difficulty": "medium", "explanation": "Session hijacking involves stealing or reusing session tokens. Use HttpOnly, Secure, SameSite flags and rotation to mitigate."},
  {"question": "What does HSTS (Strict-Transport-Security) do?", "choices": ["Forces HTTP only", "Tells browsers to use HTTPS for the site", "Disables TLS", "Manages CORS"], "answer": "Tells browsers to use HTTPS for the site", "difficulty": "easy", "explanation": "HSTS instructs browsers to always use HTTPS for a domain for a specified period."},
  {"question": "Which practice improves API security against automated abuse?", "choices": ["Allow anonymous unlimited requests", "Rate limiting and authentication", "Disabling all logs", "Using self-signed certs for public APIs"], "answer": "Rate limiting and authentication", "difficulty": "medium", "explanation": "Rate limiting and requiring authentication help protect APIs from abuse."},
  {"question": "What is mutual TLS (mTLS)?", "choices": ["Client and server both present certificates", "Only server uses a certificate", "TLS without encryption", "A TLS downgrade"], "answer": "Client and server both present certificates", "difficulty": "hard", "explanation": "mTLS authenticates both client and server using certificates, commonly used for service-to-service auth."},
  {"question": "What is forward secrecy?", "choices": ["Using shorter certificates", "Ensuring past sessions can't be decrypted if long-term keys are compromised", "A TLS version", "Certificate revocation"], "answer": "Ensuring past sessions can't be decrypted if long-term keys are compromised", "difficulty": "medium", "explanation": "Forward secrecy uses ephemeral key exchanges (e.g., ECDHE) so session keys are not derivable from server private keys."},
  {"question": "Which TLS version removed RSA key exchange and improved handshake performance?", "choices": ["TLS 1.0", "TLS 1.1", "TLS 1.2", "TLS 1.3"], "answer": "TLS 1.3", "difficulty": "medium", "explanation": "TLS 1.3 simplifies the handshake, deprecates non-PFS key exchange, and improves privacy and performance."},
  {"question": "What is OCSP stapling used for?", "choices": ["Checking DNS records", "A client-side cache", "Server provides a signed revocation status to clients", "Issuing certificates"], "answer": "Server provides a signed revocation status to clients", "difficulty": "medium", "explanation": "OCSP stapling lets the server present a CA-signed OCSP response to prove the certificate hasn't been revoked, improving privacy and performance."},
  {"question": "What is Certificate Transparency (CT)?", "choices": ["A Linux tool", "Public logs of certificates for detection and auditing", "A TLS cipher", "A CA type"], "answer": "Public logs of certificates for detection and auditing", "difficulty": "medium", "explanation": "CT logs help detect misissued certificates by making them publicly visible and auditable."},
  {"question": "Which header enforces browser security to only use HTTPS and can be preloaded?", "choices": ["X-Content-Type-Options", "Strict-Transport-Security", "Referrer-Policy", "Expect-CT"], "answer": "Strict-Transport-Security", "difficulty": "easy", "explanation": "HSTS tells browsers to enforce HTTPS; domains can be added to the HSTS preload list for major browsers."},
  {"question": "What does the 'HttpOnly' cookie flag do?", "choices": ["Makes cookie encrypted", "Prevents client-side JavaScript from reading the cookie", "Expires the cookie faster", "Makes it domain-only"], "answer": "Prevents client-side JavaScript from reading the cookie", "difficulty": "easy", "explanation": "HttpOnly reduces XSS-driven token theft by making the cookie inaccessible to JS document.cookie."},
  {"question": "What is CORS primarily intended to control?", "choices": ["Which servers can be contacted by the browser", "Which resources a page can load", "Cross-origin resource access from browsers", "TLS cipher negotiation"], "answer": "Cross-origin resource access from browsers", "difficulty": "easy", "explanation": "CORS policies control which origins JavaScript in browsers may make cross-origin requests to and access responses from."},
  {"question": "Which header can mitigate XSS by restricting allowed script sources?", "choices": ["CSP (Content-Security-Policy)", "X-Frame-Options", "Server-Timing", "X-Powered-By"], "answer": "CSP (Content-Security-Policy)", "difficulty": "medium", "explanation": "CSP lets sites specify allowed script sources, reducing XSS attack surface when used correctly."},
  {"question": "What vulnerability does SameSite cookie attribute help mitigate?", "choices": ["XSS", "CSRF", "SQL Injection", "MITM"], "answer": "CSRF", "difficulty": "medium", "explanation": "SameSite=Lax/Strict prevents browsers from sending cookies on cross-site requests for many flows, reducing CSRF risk."},
  {"question": "What is a common risk of storing JWTs in localStorage?", "choices": ["They expire too fast", "They are easily stolen via XSS", "They can't be sent with requests", "They are encrypted by default"], "answer": "They are easily stolen via XSS", "difficulty": "medium", "explanation": "Storing tokens in localStorage exposes them to JavaScript access which XSS can exploit; HttpOnly cookies mitigate this."},
  {"question": "Which OAuth2 flow is recommended for single-page apps?", "type": "text", "choices": ["Authorization Code with PKCE", "Implicit flow", "Client Credentials", "Resource Owner Password Credentials"], "answer": "Authorization Code with PKCE", "difficulty": "medium", "explanation": "PKCE adds a verifier to the authorization code flow to protect public clients like SPAs from interception attacks."},
  {"question": "What is the primary benefit of rotating credentials frequently?", "choices": ["Increases user convenience", "Limits the window of exposure if leaked", "Improves TLS handshake speed", "Reduces logging"], "answer": "Limits the window of exposure if leaked", "difficulty": "easy", "explanation": "Regular rotation reduces the time an attacker can misuse leaked credentials."},
  {"question": "What is OCSP?", "choices": ["A protocol for checking certificate revocation status", "A TLS cipher", "A load balancer", "A web cache"], "answer": "A protocol for checking certificate revocation status", "difficulty": "medium", "explanation": "OCSP allows clients to query a CA about a certificate's revocation status."},
  {"question": "What does 'pinning' a public key in a browser do long-term?", "choices": ["Always trusts any certificate", "Prevents all MITM", "Makes certificate rotation riskier", "Replaces OCSP"], "answer": "Makes certificate rotation riskier", "difficulty": "hard", "explanation": "Pinning reduces MITM risk but introduces operational risk: a rotated key can lock out clients if not managed correctly."},
  {"question": "Which header stops MIME-type sniffing?", "choices": ["X-Content-Type-Options: nosniff", "X-Frame-Options: DENY", "Content-Security-Policy", "Referrer-Policy"], "answer": "X-Content-Type-Options: nosniff", "difficulty": "easy", "explanation": "nosniff prevents browsers from guessing response MIME types, reducing certain XSS/file interpretation attacks."},
  {"question": "What is 'certificate revocation' used for?", "choices": ["Extending cert validity", "Invalidating compromised or revoked certs", "Issuing new certs", "Encrypting traffic"], "answer": "Invalidating compromised or revoked certs", "difficulty": "medium", "explanation": "Revocation mechanisms (CRL, OCSP) let CAs mark certificates as no longer trustworthy."},
  {"question": "Which of the following reduces the impact of XSS?", "type": "multiple", "choices": ["HttpOnly cookies", "CSP", "Output encoding", "All of the above"], "answer": ["HttpOnly cookies", "CSP", "Output encoding"], "difficulty": "medium", "explanation": "Combining HttpOnly cookies, Content Security Policy, and proper output encoding reduces XSS risk."},
  {"question": "Which attack abuses the browser's trust in the origin for state-changing requests?", "choices": ["CSRF", "XSS", "Clickjacking", "Directory Traversal"], "answer": "CSRF", "difficulty": "easy", "explanation": "CSRF tricks authenticated users into making unintended requests to a site that trusts their session."},
  {"question": "What is Subresource Integrity (SRI) used for?", "choices": ["Encrypting CDN resources", "Verifying integrity of resources loaded from third parties", "Replacing TLS", "Making cookies secure"], "answer": "Verifying integrity of resources loaded from third parties", "difficulty": "medium", "explanation": "SRI adds cryptographic hashes to external script/link tags so the browser verifies content hasn't changed."},
  {"question": "Which practice helps detect certificate misissuance?", "choices": ["Certificate Transparency logs", "Using self-signed certs", "Disabling OCSP", "Hiding cert chains"], "answer": "Certificate Transparency logs", "difficulty": "medium", "explanation": "CT logs make certificates observable and help detect misissuance by CAs."},
  {"question": "What is a common mitigation for brute-force login attempts?", "choices": ["Rate limiting and account lockouts", "Longer TLS keys", "Disabling TLS", "Using self-signed certs"], "answer": "Rate limiting and account lockouts", "difficulty": "easy", "explanation": "Rate limiting, throttling, and MFA reduce the impact of automated password attacks."},
  {"question": "What does 'Http Strict Transport Security' header protect against?", "choices": ["Cross-site scripting", "Downgrade to HTTP and man-in-the-middle", "SQL injection", "DNS spoofing"], "answer": "Downgrade to HTTP and man-in-the-middle", "difficulty": "medium", "explanation": "HSTS forces browsers to use HTTPS, preventing certain downgrade and MITM attacks that rely on HTTP."},
  {"question": "Which DNS record can restrict which CAs may issue certificates for your domain?", "choices": ["CAA (Certification Authority Authorization)", "TXT for SPF", "MX record", "SRV record"], "answer": "CAA (Certification Authority Authorization)", "difficulty": "medium", "explanation": "CAA DNS records let domain owners specify which CAs are authorized to issue certs for that domain."},
  {"question": "What is 'OCSP stapling' advantage over naive OCSP?", "choices": ["More privacy and lower latency", "Removes need for certificates", "Adds encryption", "Prevents all attacks"], "answer": "More privacy and lower latency", "difficulty": "medium", "explanation": "OCSP stapling avoids client-side OCSP lookups by having the server present a signed OCSP response."},
  {"question": "What is the role of SNI (Server Name Indication)?", "choices": ["Selecting virtual host certificate during TLS handshake", "Encrypting DNS", "Revoking certs", "Managing cookies"], "answer": "Selecting virtual host certificate during TLS handshake", "difficulty": "medium", "explanation": "SNI allows multiple TLS sites to be hosted on one IP by indicating the target hostname during handshake."},
  {"question": "Which attack exploited weak TLS ciphers in older browsers like POODLE?", "choices": ["POODLE", "HEARTBLEED", "BREACH", "Clickjacking"], "answer": "POODLE", "difficulty": "hard", "explanation": "POODLE exploited fallback to SSLv3 and block-cipher padding issues; disabling SSLv3 and using modern TLS ciphers mitigates it."},
  {"question": "What is certificate revocation checking failure's practical risk?", "choices": ["Clients always block access", "Clients may accept revoked certs if checks are skipped", "It breaks TLS entirely", "It speeds up connections"], "answer": "Clients may accept revoked certs if checks are skipped", "difficulty": "medium", "explanation": "Incomplete revocation checking or soft-fail behavior can allow compromised certificates to be accepted."},
  {"question": "Which token should be rotated frequently and stored securely: access token or refresh token?", "choices": ["Access token only", "Refresh token only", "Both should be protected; refresh tokens are long-lived and need careful handling", "Neither"], "answer": "Both should be protected; refresh tokens are long-lived and need careful handling", "difficulty": "medium", "explanation": "Refresh tokens often have longer lifetimes and thus require stronger protections and rotation strategies."},
  {"question": "Which header can request certificate transparency enforcement?", "choices": ["Expect-CT", "X-Frame-Options", "Content-Security-Policy", "Feature-Policy"], "answer": "Expect-CT", "difficulty": "hard", "explanation": "Expect-CT was an attempt to allow sites to ensure browsers enforce CT expectations; browser support is limited."},
  {"question": "What is the aim of rate limiting at API gateways?", "choices": ["Preventing misconfigurations", "Protecting backend resources from abuse and DoS", "Encrypting payloads", "Issuing certificates"], "answer": "Protecting backend resources from abuse and DoS", "difficulty": "easy", "explanation": "Rate limiting controls request volume per client to prevent abuse and resource exhaustion."},
  {"question": "Which is a phishing-resistant MFA factor?", "choices": ["SMS OTP", "TOTP apps", "Security keys (FIDO2/WebAuthn)", "Email codes"], "answer": "Security keys (FIDO2/WebAuthn)", "difficulty": "medium", "explanation": "FIDO2/WebAuthn hardware tokens are resistant to phishing and replay attacks compared to OTPs."},
  {"question": "What is 'token binding' intended to prevent?", "choices": ["Token theft and replay across clients", "TLS handshake failure", "Certificate issuance", "CORS issues"], "answer": "Token theft and replay across clients", "difficulty": "hard", "explanation": "Token binding ties issued tokens to a TLS client key so stolen tokens cannot be replayed from other clients (now largely unused)."},
  {"question": "Which of these is a best practice for public CAs and certificate handling?", "choices": ["Share private keys widely", "Monitor CT logs and automate renewals", "Disable OCSP", "Use RSA-512 keys"], "answer": "Monitor CT logs and automate renewals", "difficulty": "medium", "explanation": "Monitoring CT logs helps detect misissuance; automation reduces human error in renewals."},
  {"question": "What is the most secure place to validate JWT signatures?", "choices": ["On the client before sending", "On the server/resource server", "Only in browser console", "On CDN edge without verification"], "answer": "On the server/resource server", "difficulty": "medium", "explanation": "JWTs should be validated by the service that relies on their claims to avoid forged tokens."},
  {"question": "Which header can reduce information leakage by hiding server technology?", "choices": ["Remove X-Powered-By header", "Add Server header", "Enable TRACE", "Allow directory listing"], "answer": "Remove X-Powered-By header", "difficulty": "easy", "explanation": "Removing informative headers reduces fingerprinting, though it is not a strong security control by itself."},
  {"question": "What is 'refresh token rotation'?", "choices": ["Never change refresh tokens", "Issue a new refresh token when the old one is used, invalidating the previous", "Store refresh tokens in localStorage", "Send refresh tokens to third parties"], "answer": "Issue a new refresh token when the old one is used, invalidating the previous", "difficulty": "hard", "explanation": "Rotation limits replay risk; combining rotation with detection helps secure long-lived sessions."},
  {"question": "Which control helps prevent sensitive data exposure in transit?", "choices": ["TLS with strong ciphers and HSTS", "Storing secrets in code", "Using HTTP only", "Disabling certificates"], "answer": "TLS with strong ciphers and HSTS", "difficulty": "easy", "explanation": "Use modern TLS config, prefer TLS 1.3, and enable HSTS to ensure secure transit."},
  {"question": "Which of these is a common cause of certificate expiration outages?", "choices": ["Automated renewal misconfiguration", "Too short key length", "OCSP stapling enabled", "CSP misconfiguration"], "answer": "Automated renewal misconfiguration", "difficulty": "medium", "explanation": "Failures in automated renewal or deployment processes commonly cause cert expiry outages."},
  {"question": "What does 'SRI' stand for and why is it used?", "choices": ["Secure Resource Interface", "Subresource Integrity - verify third-party assets haven't changed", "Server Response Identifier", "Session Revocation Index"], "answer": "Subresource Integrity - verify third-party assets haven't changed", "difficulty": "medium", "explanation": "SRI ensures that scripts/styles loaded from CDNs match expected cryptographic hashes."},
  {"question": "Which approach helps secure microservice-to-microservice communication?", "choices": ["mTLS, service identity and least privilege", "No TLS for performance", "Hard-coded credentials in images", "Open ports to all networks"], "answer": "mTLS, service identity and least privilege", "difficulty": "medium", "explanation": "mTLS combined with short-lived credentials and principle of least privilege improves inter-service security."},
  {"question": "Which HTTP header can request the browser not send a Referer on cross-origin requests?", "choices": ["Referrer-Policy", "X-Frame-Options", "Expect-CT", "X-Content-Type-Options"], "answer": "Referrer-Policy", "difficulty": "easy", "explanation": "Referrer-Policy controls how much referrer information is sent with requests, reducing information leakage."},
  {"question": "What is a key benefit of using a Web Application Firewall (WAF)?", "choices": ["Automatic certificate rotation", "Filtering and blocking known web attack patterns", "Replacing TLS", "Storing secrets"], "answer": "Filtering and blocking known web attack patterns", "difficulty": "medium", "explanation": "WAFs help mitigate common web attacks (SQLi, XSS, known malicious patterns) but are not a substitute for secure code."},
  {"question": "Which practice is recommended for CAs to avoid weak signatures?", "choices": ["Use modern hash algorithms like SHA-256", "Use MD5 for compatibility", "Sign certificates without hashing", "Use plaintext signatures"], "answer": "Use modern hash algorithms like SHA-256", "difficulty": "easy", "explanation": "Older hash algorithms are vulnerable; modern CAs and servers use SHA-256 or stronger."},
  {"question": "What is the purpose of 'SameSite=None; Secure' on cookies?", "choices": ["Allow cross-site cookie and ensure it's only sent over HTTPS", "Block all cookies", "Make cookie readable by JS", "Disable TLS"], "answer": "Allow cross-site cookie and ensure it's only sent over HTTPS", "difficulty": "medium", "explanation": "SameSite=None allows cross-site usage (e.g., third-party) and Secure ensures it's only sent over TLS."}
]
